<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Xamarin.Android Activity入门介绍 | Mayue‘s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
    <meta name="keywords" content="Mayue's Blog" />
  
  <meta name="description" content="本文将对Android四大组件之一的Activity进行简单介绍。Activity是一个应用程序的组件，他在屏幕上提供了一个区域，允许用户在上面做一些交互性的操作， 比如打电话，照相，发送邮件，或者显示一个地图！Activity可以理解成一个绘制用户界面的窗口， 而这个窗口可以填满整个屏幕，也可能比屏幕小或者浮动在其他窗口的上方！">
<meta name="keywords" content="Activity">
<meta property="og:type" content="article">
<meta property="og:title" content="Xamarin.Android Activity入门介绍">
<meta property="og:url" content="http://xamarin.xyz/2016/04/28/activity1/index.html">
<meta property="og:site_name" content="Mayue‘s Blog">
<meta property="og:description" content="本文将对Android四大组件之一的Activity进行简单介绍。Activity是一个应用程序的组件，他在屏幕上提供了一个区域，允许用户在上面做一些交互性的操作， 比如打电话，照相，发送邮件，或者显示一个地图！Activity可以理解成一个绘制用户界面的窗口， 而这个窗口可以填满整个屏幕，也可能比屏幕小或者浮动在其他窗口的上方！">
<meta property="og:image" content="https://developer.xamarin.com/guides/android/application_fundamentals/activity_lifecycle/Images/image2.png">
<meta property="og:image" content="http://www.runoob.com/wp-content/uploads/2015/08/291262381.jpg">
<meta property="og:image" content="https://developer.xamarin.com/guides/android/application_fundamentals/activity_lifecycle/Images/image3-sml.png">
<meta property="og:updated_time" content="2017-11-02T15:06:35.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Xamarin.Android Activity入门介绍">
<meta name="twitter:description" content="本文将对Android四大组件之一的Activity进行简单介绍。Activity是一个应用程序的组件，他在屏幕上提供了一个区域，允许用户在上面做一些交互性的操作， 比如打电话，照相，发送邮件，或者显示一个地图！Activity可以理解成一个绘制用户界面的窗口， 而这个窗口可以填满整个屏幕，也可能比屏幕小或者浮动在其他窗口的上方！">
<meta name="twitter:image" content="https://developer.xamarin.com/guides/android/application_fundamentals/activity_lifecycle/Images/image2.png">
  
  
    <link rel="icon" href="/favicon.ico">
  
  <link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  <script src="/js/pace.min.js"></script>
  

  
  
  <div style="display: none;">
    <script src="//s22.cnzz.com/z_stat.php?id=1267783553&web_id=1267783553" language="JavaScript"></script>
  </div>


</head>

<body>
  <div id="container">
      <header id="header">
    <div id="banner"></div>
    <div id="header-outer">
        <div id="header-menu" class="header-menu-pos animated">
            <div class="header-menu-container">
                <a href="/" class="left">
                    <span class="site-title">Mayue&#39;s Blog</span>
                </a>
                <nav id="header-menu-nav" class="right">
                    
                    <a  href="/">
                        <i class="fa fa-home"></i>
                        <span>Home</span>
                    </a>
                    
                    <a  href="/archives">
                        <i class="fa fa-archive"></i>
                        <span>Archives</span>
                    </a>
                    
                    <a  href="/about">
                        <i class="fa fa-user"></i>
                        <span>About</span>
                    </a>
                    
                </nav>
                <a class="mobile-header-menu-button">
                    <i class="fa fa-bars"></i>
                </a>
            </div>
        </div>
        <div id="header-row">
            <div id="logo">
                <a href="/">
                    <img src="/images/logo.png" alt="logo">
                </a>
            </div>
            <div class="header-info">
                <div id="header-title">
                    
                    <h2>
                        Mayue&#39;s Blog
                    </h2>
                    
                </div>
                <div id="header-description">
                    
                    <h3>
                        一个专注移动开发的技术博客
                    </h3>
                    
                </div>
            </div>
            <nav class="header-nav">
                <div class="social">
                    
                        <a  target="_blank" href="http://shang.qq.com/wpa/qunwpa?idkey=68c5293ab4e4398e351e198d8a4475fb72334e840d58e03cc5e5a60422b36e8b">
                            <i class="fa fa-qq fa-2x"></i></a>
                    
                </div>
            </nav>
        </div>
    </div>
</header>
      <div class="outer">
        <section id="main" class="body-wrap"><article id="post-activity1" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="post-title" itemprop="name">
      Xamarin.Android Activity入门介绍
    </h1>
    <div class="post-title-bar">
      <ul>
          
              <li>
                  <i class="fa fa-book"></i>
                  
                      <a href="/categories/Android/">Android</a>
                  
              </li>
          
        <li>
          <i class="fa fa-calendar"></i>  2016-04-28
        </li>
        <li>
          <i class="fa fa-eye"></i>
          <span id="busuanzi_value_page_pv"></span>
        </li>
      </ul>
    </div>
  

          
      </header>
    
    <div class="article-entry post-content" itemprop="articleBody">
      
            
            <p>本文将对Android四大组件之一的Activity进行简单介绍。<br>Activity是一个应用程序的组件，他在屏幕上提供了一个区域，允许用户在上面做一些交互性的操作， 比如打电话，照相，发送邮件，或者显示一个地图！Activity可以理解成一个绘制用户界面的窗口， 而这个窗口可以填满整个屏幕，也可能比屏幕小或者浮动在其他窗口的上方！<br><a id="more"></a></p>
<h1 id="Activity生命周期介绍"><a href="#Activity生命周期介绍" class="headerlink" title="Activity生命周期介绍"></a>Activity生命周期介绍</h1><p><img src="https://developer.xamarin.com/guides/android/application_fundamentals/activity_lifecycle/Images/image2.png" alt="Activity生命周期"></p>
<p>建议自己写Demo查看各个生命周期调用时间。</p>
<h2 id="OnCreate"><a href="#OnCreate" class="headerlink" title="OnCreate"></a>OnCreate</h2><p>当Activity创建时会调用此方法，是我们必须要重写的方法，该方法传入一个Bundle对象作为参数。如果bundle不为null，说明当前Activity是重新启动。可以通过bundle读取我们之前保存的数据，做相应的数据恢复工作。在这个方法中要执行的操作是：</p>
<blockquote>
<p>Creating views</p>
<p>Initializing variables</p>
<p>Binding static data to lists</p>
</blockquote>
<h2 id="OnStart"><a href="#OnStart" class="headerlink" title="OnStart"></a>OnStart</h2><p>OnCreate执行结束会掉用OnStart方法，可以根据具体应用情况重写该方法。</p>
<h2 id="OnResume"><a href="#OnResume" class="headerlink" title="OnResume"></a>OnResume</h2><p>当一个Activity初始化完成准备显示给用户时会掉用OnResume方法。此时Activity进入活动状态。在这个方法中我们要做的是：</p>
<blockquote>
<p>Ramping up frame rates (a common task in game building)</p>
<p>Starting animations</p>
<p>Listening for GPS updates</p>
<p>Display any relevant alerts or dialogs</p>
<p>Wire up external event handlers</p>
</blockquote>
<h2 id="OnPause"><a href="#OnPause" class="headerlink" title="OnPause"></a>OnPause</h2><p>当Activity进入后台或者Activity被遮挡时（Dialog风格的Activity）掉用此方法。OnPause方法之行过后Activity可以有两种不同的状态，进入OnResume返回前台或者进入OnStop方法，重写这个方法我们要做的是：</p>
<blockquote>
<p>Commit unsaved changes to persistent data</p>
<p>Destroy or clean up other objects consuming resources</p>
<p>Ramp down frame rates and pausing animations</p>
<p>Unregister external event handlers or notification handlers (i.e. those that are tied to a service). This must be done to prevent Activity memory leaks.</p>
<p>Likewise, if the Activity has displayed any dialogs or alerts, they must be cleaned up with the .Dismiss() method.</p>
</blockquote>
<p>最后一条，如果不关闭已经显示的Dialog会抛异常。</p>
<h2 id="OnStop"><a href="#OnStop" class="headerlink" title="OnStop"></a>OnStop</h2><p>Activity不再显示时调用此方法，此时Activity仍存留在内存中。</p>
<h2 id="OnDestroy"><a href="#OnDestroy" class="headerlink" title="OnDestroy"></a>OnDestroy</h2><p>Activity销毁调用次方法，此时Activity已经完全从内存中移除，我们应该重写此方法，释放占用的资源。</p>
<h2 id="OnRestart"><a href="#OnRestart" class="headerlink" title="OnRestart"></a>OnRestart</h2><p>是OnStop状态的Activity重新显示给用户会进入OnRestart方法。如按下Home键应用进入后台，重新打开应用，Activity重新启动。</p>
<h1 id="Activity使用"><a href="#Activity使用" class="headerlink" title="Activity使用"></a>Activity使用</h1><blockquote>
<p>Android中的四大组件，只要你定义了就必须在AndroidManifest.xml中对这个组件进行声明。</p>
</blockquote>
<h2 id="定义Activity"><a href="#定义Activity" class="headerlink" title="定义Activity"></a>定义Activity</h2><p>我们自定义的Activity一定要继承Activity或其子类（如AppCompatActivity），并重写相关方法。OnCreate是必须重写的，在OnCreate中调用SetContentView方法加载相关联的视图。</p>
<h2 id="声明Activity"><a href="#声明Activity" class="headerlink" title="声明Activity"></a>声明Activity</h2><p>在AndroidManifest中增加Activity节点。<br><a href="http://www.android-doc.com/guide/topics/manifest/activity-element.html" target="_blank" rel="external">参考文档</a></p>
<p>Xamarin.Android中我们可以通过声明特性进行组件的声明。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[<span class="meta">Activity (Label = <span class="meta-string">"activity1"</span>, MainLauncher = true, Icon = <span class="meta-string">"@mipmap/icon"</span>)</span>]</div></pre></td></tr></table></figure>
<p>项目编译时会根据我们声明的特性生成新的AndroidManifest.xml文件</p>
<blockquote>
<p>可在项目目录下 /项目名/obj/Debug or Release/android下查看</p>
</blockquote>
<h2 id="启动Activity"><a href="#启动Activity" class="headerlink" title="启动Activity"></a>启动Activity</h2><p>启动方式：</p>
<ul>
<li>显式启动 </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Intent intent = new Intent (this, typeof(Activity2));</div><div class="line">StartActivity (intent);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">StartActivity(typeof(Activity2));</div></pre></td></tr></table></figure>
<p>Intent对象可以在两个Activity间传递数据。</p>
<ul>
<li>隐式启动</li>
</ul>
<p>给出Java示例</p>
<p><img src="http://www.runoob.com/wp-content/uploads/2015/08/291262381.jpg" alt="隐式启动"></p>
<h1 id="生命周期中状态的保存"><a href="#生命周期中状态的保存" class="headerlink" title="生命周期中状态的保存"></a>生命周期中状态的保存</h1><h2 id="Bundle保存状态"><a href="#Bundle保存状态" class="headerlink" title="Bundle保存状态"></a>Bundle保存状态</h2><p>通过OnSaveInstanceState、OnRestoreInstanceState两个方法管理保存的状态（不是一定会执行的）</p>
<p>以下代码，改变默认创建的Android项目，是一个简单保存状态的例子，可以通过横竖屏切换掉用OnSaveInstanceState、OnRestoreInstanceState方法。（这里提到横竖屏切换，我们可以为一个Activity分别提供不同情况下的布局文件，创建两个布局文件夹：layout-land横屏,layout-port竖屏 然后把两套布局文件丢这两文件夹里，文件名一样，Android就会自行判断加载相应布局）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">[Activity (Label = &quot;activity1&quot;, MainLauncher = true, Icon = &quot;@mipmap/icon&quot;)]</div><div class="line">	public class MainActivity : Activity</div><div class="line">	&#123;</div><div class="line">		int count = 1;</div><div class="line">		Button button;</div><div class="line"></div><div class="line">		protected override void OnCreate (Bundle savedInstanceState)</div><div class="line">		&#123;</div><div class="line">			base.OnCreate (savedInstanceState);</div><div class="line"></div><div class="line">			// Set our view from the &quot;main&quot; layout resource</div><div class="line">			SetContentView (Resource.Layout.Main);</div><div class="line"></div><div class="line">			// Get our button from the layout resource,</div><div class="line">			// and attach an event to it</div><div class="line">			button = FindViewById&lt;Button&gt; (Resource.Id.myButton);</div><div class="line">			</div><div class="line">			button.Click += delegate &#123;</div><div class="line">				button.Text = string.Format (&quot;&#123;0&#125; clicks!&quot;, count++);</div><div class="line">			&#125;;</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		protected override void OnSaveInstanceState (Bundle outState)</div><div class="line">		&#123;</div><div class="line">			base.OnSaveInstanceState (outState);</div><div class="line">			outState.PutInt (&quot;count&quot;, count);</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		protected override void OnRestoreInstanceState (Bundle savedInstanceState)</div><div class="line">		&#123;</div><div class="line">			base.OnRestoreInstanceState (savedInstanceState);</div><div class="line">			count = savedInstanceState.GetInt (&quot;count&quot;);</div><div class="line">			button.Text = string.Format (&quot;&#123;0&#125; clicks!&quot;, count);</div><div class="line">		&#125;</div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>事实上我们并不需要在OnSaveInstanceState方法中保存每个view的状态，只要指定view的ID，android系统会自动帮我们保存view的状态，如我们在布局文件中了添加一个EditText视图，并指定ID属性，运行项目，修改EditText的值，切换屏幕方向EditText中的值依然保存。</p>
</blockquote>
<p><img src="https://developer.xamarin.com/guides/android/application_fundamentals/activity_lifecycle/Images/image3-sml.png" alt="Bundle State"></p>
<p>如图所示，Activity由Resumed状态变为Destroyed状态可能会调用OnSaveInstanceState方法，Created到Resumed可能会调用OnRestoreInstanceState方法。</p>
<p>使用Bundle保存状态的限制</p>
<blockquote>
<p>It is not called in all cases. For example, pressing home or back to exit an Activity will not result in OnSaveInstanceState being called.</p>
<p>The bundle passed into OnSaveInstanceState is not designed for large objects, such as images. In the case of large objects, saving the object from OnRetainNonConfigurationInstance is preferable, as discussed below.</p>
<p>Data saved by using the bundle is serialized, which can lead to delays.</p>
</blockquote>
<h2 id="复杂数据的持久化"><a href="#复杂数据的持久化" class="headerlink" title="复杂数据的持久化"></a>复杂数据的持久化</h2><p>由于Bundle的限制，只适合保存简单的数据值如：int，string等。对于复杂数据的保存我们可以通过重写OnRetainNonConfigurationInstance返回一个Java.Lang.Object，恢复数据时LastNonConfigurationInstance返回保存的数据。这里列出一个Xamarin官网的例子：</p>
<p>1.先定义我们要返回的类型</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">class TweetListWrapper : Java.Lang.Object</div><div class="line">&#123;</div><div class="line">  public string[] Tweets &#123; get; set; &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>2.Activity中处理数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div></pre></td><td class="code"><pre><div class="line">TweetListWrapper _savedInstance;</div><div class="line"></div><div class="line"></div><div class="line">		protected override void OnCreate (Bundle bundle)</div><div class="line">		&#123;</div><div class="line">			base.OnCreate (bundle);</div><div class="line"></div><div class="line">			var tweetsWrapper = LastNonConfigurationInstance as TweetListWrapper;</div><div class="line"></div><div class="line">			if (tweetsWrapper != null) &#123;</div><div class="line">				PopulateTweetList (tweetsWrapper.Tweets);</div><div class="line">			&#125; else &#123;</div><div class="line">				SearchTwitter (&quot;xamarin&quot;);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		public void SearchTwitter (string text)</div><div class="line">		&#123;</div><div class="line">			string searchUrl = String.Format (&quot;http://search.twitter.com/search.json?&quot; + &quot;q=&#123;0&#125;&amp;rpp=10&amp;include_entities=false&amp;&quot; + &quot;result_type=mixed&quot;, text);</div><div class="line">			Console.WriteLine (searchUrl);</div><div class="line">			var httpReq = (HttpWebRequest)HttpWebRequest.Create (new Uri (searchUrl));</div><div class="line">			httpReq.BeginGetResponse (new AsyncCallback (ResponseCallback), httpReq);</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		void ResponseCallback (IAsyncResult ar)</div><div class="line">		&#123;</div><div class="line">			var httpReq = (HttpWebRequest)ar.AsyncState;</div><div class="line"></div><div class="line">			using (var httpRes = (HttpWebResponse)httpReq.EndGetResponse (ar)) &#123;</div><div class="line">				ParseResults (httpRes);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		void ParseResults (HttpWebResponse httpRes)</div><div class="line">		&#123;</div><div class="line">			var s = httpRes.GetResponseStream ();</div><div class="line">			var j = (JsonObject)JsonObject.Load (s);</div><div class="line"></div><div class="line">			var results = (from result in (JsonArray)j [&quot;results&quot;]</div><div class="line">			               let jResult = result as JsonObject</div><div class="line">			               select jResult [&quot;text&quot;].ToString ()).ToArray ();</div><div class="line"></div><div class="line">			RunOnUiThread (() =&gt; &#123;</div><div class="line">				PopulateTweetList (results);</div><div class="line">			&#125;);</div><div class="line">		&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">		[Obsolete (&quot;deprecated&quot;)]</div><div class="line">		public override Java.Lang.Object OnRetainNonConfigurationInstance ()</div><div class="line">		&#123;</div><div class="line">			base.OnRetainNonConfigurationInstance ();</div><div class="line">			Console.WriteLine (&quot;OnRetainNonConfigurationInstance&quot;);</div><div class="line">			return _savedInstance;</div><div class="line">		&#125;</div><div class="line"></div><div class="line"></div><div class="line">		void PopulateTweetList (string[] results)</div><div class="line">		&#123;</div><div class="line">			ListAdapter = new ArrayAdapter&lt;string&gt; (this, Android.Resource.Layout.SimpleListItem1, results);</div><div class="line">			_savedInstance = new TweetListWrapper&#123; Tweets = results &#125;;</div><div class="line">		&#125;</div></pre></td></tr></table></figure>
<p>可以注意到OnRetainNonConfigurationInstance方法已经是过期的，查看文档可以看到：</p>
<blockquote>
<p>Called by the system, as part of destroying an activity due to a configuration change, when it is known that a new instance will immediately be created for the new configuration. You can return any object you like here, including the activity instance itself, which can later be retrieved by calling Activity.LastNonConfigurationInstance in the new activity instance. If you are targeting Build+VERSION_CODES.Honeycomb or later, consider instead using a Fragment with Fragment.RetainInstance.</p>
</blockquote>
<p>我们可以用Fragment.RetainInstance完成同样的事情。</p>
<h1 id="系统提供常用Activity"><a href="#系统提供常用Activity" class="headerlink" title="系统提供常用Activity"></a>系统提供常用Activity</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div></pre></td><td class="code"><pre><div class="line">//1.拨打电话</div><div class="line">// 给移动客服10086拨打电话</div><div class="line">Uri uri = Uri.Parse (&quot;tel:10086&quot;);</div><div class="line">Intent intent = new Intent (Intent.ActionDial, uri);</div><div class="line">StartActivity (intent);</div><div class="line"></div><div class="line">//2.发送短信</div><div class="line">// 给10086发送内容为“Hello”的短信</div><div class="line">Uri uri = Uri.Parse (&quot;smsto:10086&quot;);</div><div class="line">Intent intent = new Intent (Intent.ActionSendto, uri);</div><div class="line">intent.PutExtra (&quot;sms_body&quot;, &quot;Hello&quot;);</div><div class="line">StartActivity (intent);</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">//3.发送彩信（相当于发送带附件的短信）</div><div class="line">Intent intent = new Intent(Intent.ActionSend);</div><div class="line">intent.PutExtra(&quot;sms_body&quot;, &quot;Hello&quot;);</div><div class="line">Uri uri = Uri.Parse(&quot;content://media/external/images/media/23&quot;);</div><div class="line">intent.PutExtra(Intent.ExtraStream, uri);</div><div class="line">intent.SetType(&quot;image/png&quot;);</div><div class="line">StartActivity(intent);</div><div class="line"></div><div class="line">//4.打开浏览器:</div><div class="line">Uri uri = Uri.Parse (&quot;http://www.baidu.com&quot;);</div><div class="line">Intent intent = new Intent (Intent.ActionView, uri);</div><div class="line">StartActivity (intent);</div><div class="line"></div><div class="line"></div><div class="line">//5.多媒体播放:</div><div class="line">Intent intent = new Intent(Intent.ActionView);</div><div class="line">Uri uri = Uri.Parse(&quot;file:///sdcard/foo.mp3&quot;);</div><div class="line">intent.SetDataAndType(uri, &quot;audio/mp3&quot;);</div><div class="line">StartActivity(intent);</div><div class="line"></div><div class="line"></div><div class="line">//6.打开摄像头拍照:</div><div class="line">// 打开拍照程序</div><div class="line">Intent intent = new Intent(MediaStore.ActionImageCapture); </div><div class="line">StartActivityForResult(intent, 0);</div><div class="line">// 取出照片数据</div><div class="line">Bundle extras = intent.Extras; </div><div class="line">Bitmap bitmap = (Bitmap) extras.Get(&quot;data&quot;);</div><div class="line"></div><div class="line">//另一种:</div><div class="line">//调用系统相机应用程序，并存储拍下来的照片</div><div class="line">Intent intent = new Intent(MediaStore.ActionImageCapture); </div><div class="line">var time = Calendar.GetInstance().TimeInMillis;</div><div class="line">intent.PutExtra(MediaStore.ExtraOutput, Uri.FromFile(new File(path, time + &quot;.jpg&quot;)));</div><div class="line">StartActivityForResult(intent, 0);</div><div class="line"></div><div class="line">//7.获取并剪切图片</div><div class="line">// 获取并剪切图片</div><div class="line">Intent intent = new Intent(Intent.ActionGetContent);</div><div class="line">intent.SetType(&quot;image/*&quot;);</div><div class="line">intent.PutExtra(&quot;crop&quot;, &quot;true&quot;); // 开启剪切</div><div class="line">intent.PutExtra(&quot;aspectX&quot;, 1); // 剪切的宽高比为1：2</div><div class="line">intent.PutExtra(&quot;aspectY&quot;, 2);</div><div class="line">intent.PutExtra(&quot;outputX&quot;, 20); // 保存图片的宽和高</div><div class="line">intent.PutExtra(&quot;outputY&quot;, 40); </div><div class="line">intent.PutExtra(&quot;output&quot;, Uri.FromFile(new File(&quot;/mnt/sdcard/temp&quot;))); // 保存路径</div><div class="line">intent.PutExtra(&quot;outputFormat&quot;, &quot;JPEG&quot;);// 返回格式</div><div class="line">StartActivityForResult(intent, 0);</div><div class="line">// 剪切特定图片</div><div class="line">Intent intent = new Intent(&quot;com.android.camera.action.CROP&quot;); </div><div class="line">intent.SetClassName(&quot;com.android.camera&quot;, &quot;com.android.camera.CropImage&quot;); </div><div class="line">intent.SetData(Uri.FromFile(new File(&quot;/mnt/sdcard/temp&quot;))); </div><div class="line">intent.PutExtra(&quot;outputX&quot;, 1); // 剪切的宽高比为1：2</div><div class="line">intent.PutExtra(&quot;outputY&quot;, 2);</div><div class="line">intent.PutExtra(&quot;aspectX&quot;, 20); // 保存图片的宽和高</div><div class="line">intent.PutExtra(&quot;aspectY&quot;, 40);</div><div class="line">intent.PutExtra(&quot;scale&quot;, true);</div><div class="line">intent.PutExtra(&quot;noFaceDetection&quot;, true); </div><div class="line">intent.PutExtra(&quot;output&quot;, Uri.Parse(&quot;file:///mnt/sdcard/temp&quot;)); </div><div class="line">StartActivityForResult(intent, 0);</div><div class="line"></div><div class="line">//8.打开Google Market </div><div class="line">// 打开Google Market直接进入该程序的详细页面</div><div class="line">Uri uri = Uri.Parse (&quot;market://details?id=&quot; + &quot;com.demo.app&quot;);</div><div class="line">Intent intent = new Intent (Intent.ActionView, uri);</div><div class="line">StartActivity (intent);</div><div class="line"></div><div class="line">//9.进入手机设置界面:</div><div class="line">// 进入无线网络设置界面（其它可以举一反三）  </div><div class="line">Intent intent = new Intent (Android.Provider.Settings.ActionWirelessSettings);</div><div class="line">StartActivityForResult (intent, 0);</div><div class="line"></div><div class="line">//10.安装apk:</div><div class="line">Uri installUri = Uri.FromParts(&quot;package&quot;, &quot;xxx&quot;, null);   </div><div class="line">Intent it = new Intent(Intent.ACTION_PACKAGE_ADDED, installUri);</div><div class="line">StartActivity(it);</div><div class="line"></div><div class="line">//11.卸载apk:</div><div class="line">Uri uri = Uri.FromParts(&quot;package&quot;, strPackageName, null);      </div><div class="line">Intent it = new Intent(Intent.ACTION_DELETE, uri);      </div><div class="line">StartActivity(it); </div><div class="line"></div><div class="line"></div><div class="line">//12.进入联系人页面:</div><div class="line">Intent intent = new Intent ();</div><div class="line">intent.SetAction (Intent.ActionView);</div><div class="line">intent.SetData (Android.Provider.ContactsContract.Contacts.ContentUri);</div><div class="line">StartActivity (intent);</div><div class="line"></div><div class="line">//13.查看指定联系人:</div><div class="line">Uri personUri = ContentUris.WithAppendedId (Android.Provider.ContactsContract.Contacts.ContentUri, id);//id联系人ID</div><div class="line">Intent intent = new Intent ();</div><div class="line">intent.SetAction (Intent.ActionView);</div><div class="line">intent.SetData (personUri);</div><div class="line">StartActivity (intent);</div></pre></td></tr></table></figure>

            <div class="post-copyright">
    <div class="content">
        <p>最后更新： 2017年11月02日 23:06</p>
        <p>原始链接： <a class="post-url" href="/2016/04/28/activity1/" title="Xamarin.Android Activity入门介绍">http://xamarin.xyz/2016/04/28/activity1/</a></p>
        <footer>
            <a href="http://xamarin.xyz">
                <img src="/images/logo.png" alt="Ma Yue">
                Ma Yue
            </a>
        </footer>
    </div>
</div>

      
    </div>
    <footer class="article-footer">
        
        
<div class="post-share">
    <a href="javascript:;" id="share-sub" class="post-share-fab">
        <i class="fa fa-share-alt"></i>
    </a>
    <div class="post-share-list" id="share-list">
        <ul class="share-icons">
          <li>
            <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://xamarin.xyz/2016/04/28/activity1/&title=《Xamarin.Android Activity入门介绍》 — Mayue‘s Blog&pic=https://developer.xamarin.com/guides/android/application_fundamentals/activity_lifecycle/Images/image2.png" data-title="微博">
              <i class="fa fa-weibo"></i>
            </a>
          </li>
          <li>
            <a class="weixin share-sns" id="wxFab" href="javascript:;" data-title="微信">
              <i class="fa fa-weixin"></i>
            </a>
          </li>
          <li>
            <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://xamarin.xyz/2016/04/28/activity1/&title=《Xamarin.Android Activity入门介绍》 — Mayue‘s Blog&source=本文将对Android四大组件之一的Activity进行简单介绍。Activity是一个应用程序的组件，他在屏幕上提供了一个区域，允许用户在上面做一些交互..." data-title="QQ">
              <i class="fa fa-qq"></i>
            </a>
          </li>
          <li>
            <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://xamarin.xyz/2016/04/28/activity1/" data-title="Facebook">
              <i class="fa fa-facebook"></i>
            </a>
          </li>
          <li>
            <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Xamarin.Android Activity入门介绍》 — Mayue‘s Blog&url=http://xamarin.xyz/2016/04/28/activity1/&via=http://xamarin.xyz" data-title="Twitter">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
          <li>
            <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://xamarin.xyz/2016/04/28/activity1/" data-title="Google+">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        </ul>
     </div>
</div>
<div class="post-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;" id="wxShare-close">×</a>
    <p>扫一扫，分享到微信</p>
    <img src="//api.qrserver.com/v1/create-qr-code/?data=http://xamarin.xyz/2016/04/28/activity1/" alt="微信分享二维码">
</div>

<div class="mask"></div>

        
        <ul class="article-footer-menu">
            
            
  <li class="article-footer-tags">
    <i class="fa fa-tags"></i>
      
    <a href="/tags/Activity/" class="color4">Activity</a>
      
  </li>

        </ul>
        
    </footer>
  </div>
</article>


    <aside class="post-toc-pos post-toc-top" id="post-toc">
        <nav class="post-toc-wrap">
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Activity生命周期介绍"><span class="post-toc-text">Activity生命周期介绍</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#OnCreate"><span class="post-toc-text">OnCreate</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#OnStart"><span class="post-toc-text">OnStart</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#OnResume"><span class="post-toc-text">OnResume</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#OnPause"><span class="post-toc-text">OnPause</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#OnStop"><span class="post-toc-text">OnStop</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#OnDestroy"><span class="post-toc-text">OnDestroy</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#OnRestart"><span class="post-toc-text">OnRestart</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Activity使用"><span class="post-toc-text">Activity使用</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#定义Activity"><span class="post-toc-text">定义Activity</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#声明Activity"><span class="post-toc-text">声明Activity</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#启动Activity"><span class="post-toc-text">启动Activity</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#生命周期中状态的保存"><span class="post-toc-text">生命周期中状态的保存</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Bundle保存状态"><span class="post-toc-text">Bundle保存状态</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#复杂数据的持久化"><span class="post-toc-text">复杂数据的持久化</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#系统提供常用Activity"><span class="post-toc-text">系统提供常用Activity</span></a></li></ol>
        </nav>
    </aside>
    

<nav id="article-nav">
  
    <a href="/2016/04/29/activity2/" id="article-nav-newer" class="article-nav-link-wrap">

      <span class="article-nav-title">
        <i class="fa fa-hand-o-left" aria-hidden="true"></i>
        
          Xamarin.Android Activity用例介绍
        
      </span>
    </a>
  
  
</nav>



    
        <div id="SOHUCS" sid="activity1" ></div>
<script type="text/javascript">
    (function(){
        var appid = 'cytiEtVv3';
        var conf = 'd44a3fd145c147e05a5cb60af157d81e';
        var width = window.innerWidth || document.documentElement.clientWidth;
        if (width < 960) {
            window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>'); } else { var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})}); } })(); </script>
    
</section>
        
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info" class="inner">
      
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


      <p>
        Powered by  <a href="http://hexo.io/" target="_blank">Hexo</a>
        Theme <a href="//github.com/wongminho/hexo-theme-miho" target="_blank">MiHo</a>
      &copy; 2017 Ma Yue<br>
      </p>
    </div>
  </div>
</footer>
    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script>
  var mihoConfig = {
      root: "http://xamarin.xyz",
      animate: true,
      isHome: false,
      share: true
  }
</script>
<div class="sidebar">
    <div id="sidebar-search" title="Search">
        <i class="fa fa-search"></i>
    </div>
    <div id="sidebar-category" title="Categories">
        <i class="fa fa-book"></i>
    </div>
    <div id="sidebar-tag" title="Tags">
        <i class="fa fa-tags"></i>
    </div>
    <div id="sidebar-top">
        <span class="sidebar-top-icon"><i class="fa fa-angle-up"></i></span>
    </div>
</div>
<div class="sidebar-menu-box" id="sidebar-menu-box">
    <div class="sidebar-menu-box-container">
        <div id="sidebar-menu-box-categories">
            <a class="category-link" href="/categories/Android/">Android</a><a class="category-link" href="/categories/Xamarin-Forms/">Xamarin.Forms</a>
        </div>
        <div id="sidebar-menu-box-tags">
            <a href="/tags/AbsoluteLayout/" style="font-size: 10px;">AbsoluteLayout</a> <a href="/tags/Activity/" style="font-size: 16.67px;">Activity</a> <a href="/tags/Binding/" style="font-size: 10px;">Binding</a> <a href="/tags/BroadcastReceiver/" style="font-size: 10px;">BroadcastReceiver</a> <a href="/tags/Chart/" style="font-size: 10px;">Chart</a> <a href="/tags/ContentProvider/" style="font-size: 13.33px;">ContentProvider</a> <a href="/tags/DataTemplateSelector/" style="font-size: 10px;">DataTemplateSelector</a> <a href="/tags/Device/" style="font-size: 10px;">Device</a> <a href="/tags/Forms/" style="font-size: 20px;">Forms</a> <a href="/tags/Fragment/" style="font-size: 13.33px;">Fragment</a> <a href="/tags/Gesture/" style="font-size: 10px;">Gesture</a> <a href="/tags/Grid/" style="font-size: 10px;">Grid</a> <a href="/tags/Intent/" style="font-size: 10px;">Intent</a> <a href="/tags/Layout/" style="font-size: 10px;">Layout</a> <a href="/tags/ListView/" style="font-size: 10px;">ListView</a> <a href="/tags/LocalBroadcastManager/" style="font-size: 10px;">LocalBroadcastManager</a> <a href="/tags/Localizing/" style="font-size: 10px;">Localizing</a> <a href="/tags/MVVM/" style="font-size: 10px;">MVVM</a> <a href="/tags/Navigation/" style="font-size: 10px;">Navigation</a> <a href="/tags/OnPlatform/" style="font-size: 10px;">OnPlatform</a> <a href="/tags/Page/" style="font-size: 10px;">Page</a> <a href="/tags/Realm/" style="font-size: 10px;">Realm</a> <a href="/tags/Renderer/" style="font-size: 10px;">Renderer</a> <a href="/tags/Service/" style="font-size: 16.67px;">Service</a> <a href="/tags/TableView/" style="font-size: 10px;">TableView</a> <a href="/tags/View/" style="font-size: 10px;">View</a>
        </div>
    </div>
    <a href="javascript:;" class="sidebar-menu-box-close">&times;</a>
</div>
<div class="mobile-header-menu-nav" id="mobile-header-menu-nav">
    <div class="mobile-header-menu-container">
        <span class="title">Menus</span>
        <ul class="mobile-header-menu-navbar">
            
            <li>
                <a  href="/">
                    <i class="fa fa-home"></i><span>Home</span>
                </a>
            </li>
            
            <li>
                <a  href="/archives">
                    <i class="fa fa-archive"></i><span>Archives</span>
                </a>
            </li>
            
            <li>
                <a  href="/about">
                    <i class="fa fa-user"></i><span>About</span>
                </a>
            </li>
            
        </ul>
    </div>
    <div class="mobile-header-tag-container">
        <span class="title">Tags</span>
        <div id="mobile-header-container-tags">
            <a href="/tags/AbsoluteLayout/" style="font-size: 10px;">AbsoluteLayout</a> <a href="/tags/Activity/" style="font-size: 16.67px;">Activity</a> <a href="/tags/Binding/" style="font-size: 10px;">Binding</a> <a href="/tags/BroadcastReceiver/" style="font-size: 10px;">BroadcastReceiver</a> <a href="/tags/Chart/" style="font-size: 10px;">Chart</a> <a href="/tags/ContentProvider/" style="font-size: 13.33px;">ContentProvider</a> <a href="/tags/DataTemplateSelector/" style="font-size: 10px;">DataTemplateSelector</a> <a href="/tags/Device/" style="font-size: 10px;">Device</a> <a href="/tags/Forms/" style="font-size: 20px;">Forms</a> <a href="/tags/Fragment/" style="font-size: 13.33px;">Fragment</a> <a href="/tags/Gesture/" style="font-size: 10px;">Gesture</a> <a href="/tags/Grid/" style="font-size: 10px;">Grid</a> <a href="/tags/Intent/" style="font-size: 10px;">Intent</a> <a href="/tags/Layout/" style="font-size: 10px;">Layout</a> <a href="/tags/ListView/" style="font-size: 10px;">ListView</a> <a href="/tags/LocalBroadcastManager/" style="font-size: 10px;">LocalBroadcastManager</a> <a href="/tags/Localizing/" style="font-size: 10px;">Localizing</a> <a href="/tags/MVVM/" style="font-size: 10px;">MVVM</a> <a href="/tags/Navigation/" style="font-size: 10px;">Navigation</a> <a href="/tags/OnPlatform/" style="font-size: 10px;">OnPlatform</a> <a href="/tags/Page/" style="font-size: 10px;">Page</a> <a href="/tags/Realm/" style="font-size: 10px;">Realm</a> <a href="/tags/Renderer/" style="font-size: 10px;">Renderer</a> <a href="/tags/Service/" style="font-size: 16.67px;">Service</a> <a href="/tags/TableView/" style="font-size: 10px;">TableView</a> <a href="/tags/View/" style="font-size: 10px;">View</a>
        </div>
    </div>
</div>
<div class="search-wrap">
    <span class="search-close">&times;</span>
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
            <i class="icon icon-lg icon-chevron-left"></i>
        </a>
        <input class="search-field" placeholder="Search..." id="keywords">
        <a id="search-submit" href="javascript:;">
            <i class="fa fa-search"></i>
        </a>
    <div class="search-container" id="search-container">
        <ul class="search-result" id="search-result">
        </ul>
    </div>
</div>

<div id="search-tpl">
    <li class="search-result-item">
        <a href="{url}" class="search-item-li">
            <span class="search-item-li-title" title="{title}">{title}</span>
        </a>
    </li>
</div>
<script src="/js/search.js"></script>
<script src="/js/main.js"></script>


  <script src="//cdn.bootcss.com/particles.js/2.0.0/particles.min.js"></script>
  <div id="particles"></div>
  <script src="/js/particles.js"></script>







  <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  <script src="//cdn.bootcss.com/scrollReveal.js/3.0.5/scrollreveal.js"></script>
  <script src="/js/animate.js"></script>

  </div>
</body>
</html>